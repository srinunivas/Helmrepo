# Images for Fircosoft PredictionIntegrator
These images contain a coreengine and a predictionintegrator of a specific version.

## How to auto-generate the imageData files and the artifacts files
To generate the imageData files and the references/artifacts files automaticcally, you can use the tool manifesto

docker run --rm  \
    -e PRODUCT_VERSION=5.3.27.0 \
    -e CORENGINE_VERSIONS=5.6.5.9,5.6.12.0,5.6.13.3,5.6.14.0  \
    -e PREDICTIONINTEGRATOR_VERSION=5.3.21.0  \
    -e JSONUTILITIES_VERSION=5.3.16.11  \
    -e MAPPINGHTTPSTATUS_VERSION=5.3.16.12  \
    -e MAPPINGCASEMANAGERAPI_VERSION=5.3.16.3  \
    -e FIRCOCONTRACTMAPPER_VERSION=5.3.26.0  \
    -v $(pwd):/shadoker  \
    -w /shadoker  \
    jenkins-deploy.fircosoft.net/shadoker/manifesto  \
    --no-color --generate-metadata  \
    docker/continuity5/backend/fircocontractmapper-autogenerated/fircoontractmapper.mjs  \
    docker/continuity5/backend/jsonutilities-autogenerated/jsonutilities.mjs  \
    docker/continuity5/backend/mappingcasemanagerapi-autogenerated/mappingcasemanagerapi.mjs  \
    docker/continuity5/backend/mappinghttpstatus-autogenerated/mappinghttpstatus.mjs  \
    docker/continuity5/backend/pairing-autogenerated/predictionintegrator-centos-fircobase-webspheremq-oracleclient-coreengine.mjs

## How to build an image for a specific version of the DBClient
To assist in building the images, you can use the [shadoker-cli.sh](shadoker-cli.sh) script. See below for instructions and usage.

    $ ./shadoker-cli.sh ./shadoker-cli.sh docker build -d <my_image_name:my_tag>

See confluence page for more information : http://confluence.fircosoft.net/pages/viewpage.action?spaceKey=DTP&title=Shadoker+usage+for+development+teams

Or 

    $ ./shadoker-cli.sh -help

Ex:

$ ./shadoker-cli.sh docker build -d jenkins-deploy.fircosoft.net/continuity5/predictionintegrator:5.3.21.0-centos7-coreengine5.6.13.3-oracleclient19.6-webspheremq9.1.3-fircobase1.0-continuity5.3.27.0

## How to generate the refernces/images files after having build an image
To assist in generating the refernces/images file, you can use the [shadoker-cli.sh](shadoker-cli.sh) script. See below for instructions and usage.

$ ./shadoker-cli.sh docker build -d jenkins-deploy.fircosoft.net/continuity5/predictionintegrator:5.3.21.0-centos7-coreengine5.6.13.3-oracleclient19.6-webspheremq9.1.3-fircobase1.0-continuity5.3.27.0

Note : the image needs to be pushed in the Portus for this to work correctly.

## How to run the image
To run an image use the docker run command as follows:
Ex:
To run a bash in the container
    $ docker run  \
        --name predictionintegrator-5.3.21.0-centos7-oracleclient19.6-webspheremq9.1.3-coreengine5.6.13.3 \
        -it --rm \
        -v ~/work/repos/resources/resources/Continuity/licence/5.3:/home/continuity/resources/continuity5/licence \
        jenkins-deploy.fircosoft.net/continuity5/predictionintegrator:5.3.21.0-centos7-oracleclient19.6-webspheremq9.1.3-coreengine5.6.13.3 \
        /bin/bash

To start the predictionintegrator with default config
    $ docker run  \
        --name predictionintegrator-5.3.21.0-centos7-oracleclient19.6-webspheremq9.1.3-coreengine5.6.13.3 \
        -it --rm \
        -v ~/work/repos/resources/resources/Continuity/licence/5.3:/home/continuity/resources/continuity5/licence \
        jenkins-deploy.fircosoft.net/continuity5/predictionintegrator:5.3.21.0-centos7-oracleclient19.6-webspheremq9.1.3-coreengine5.6.13.3 

To start the predictionintegrator with an external config
    $ docker run  \
        --name predictionintegrator-5.3.21.0-centos7-oracleclient19.6-webspheremq9.1.3-coreengine5.6.13.3 \
        -it --rm \
        -v ~/work/repos/resources/resources/Continuity/licence/5.3:/home/continuity/resources/continuity5/licence \
        -v ~/work/repos/resources/resources/Continuity/conf/continuity5/predictionintegrator/confA:/home/continuity/resources/continuity5/config \
        jenkins-deploy.fircosoft.net/continuity5/predictionintegrator:5.3.21.0-centos7-oracleclient19.6-webspheremq9.1.3-coreengine5.6.13.3 


             

Note1 : the volume should point to a directory where to find the backend licence.

Ex:
    $ find ~/work/repos/resources/resources
    /home/vagrant/work/repos/resources/resources
    /home/vagrant/work/repos/resources/resources/Continuity
    /home/vagrant/work/repos/resources/resources/Continuity/licence
    /home/vagrant/work/repos/resources/resources/Continuity/licence/5.3
    /home/vagrant/work/repos/resources/resources/Continuity/licence/5.3/fbe.cf


Note2 : the second volume is optional and may point to a directory where to find the config for the module.

Ex:
    $ find ~/work/repos/resources/resources/Continuity/conf/continuity5/predictionintegrator 
    /home/vagrant/work/repos/resources/resources/Continuity/conf/continuity5/predictionintegrator
    /home/vagrant/work/repos/resources/resources/Continuity/conf/continuity5/predictionintegrator/confA
    /home/vagrant/work/repos/resources/resources/Continuity/conf/continuity5/predictionintegrator/confA/common_env.cfg
    /home/vagrant/work/repos/resources/resources/Continuity/conf/continuity5/predictionintegrator/confA/conf
    /home/vagrant/work/repos/resources/resources/Continuity/conf/continuity5/predictionintegrator/confA/conf/PredictionIntegrator.cfg
    /home/vagrant/work/repos/resources/resources/Continuity/conf/continuity5/predictionintegrator/confA/conf/predictionintegrator.out.rule
    /home/vagrant/work/repos/resources/resources/Continuity/conf/continuity5/predictionintegrator/confB
    /home/vagrant/work/repos/resources/resources/Continuity/conf/continuity5/predictionintegrator/confB/common_env.cfg
